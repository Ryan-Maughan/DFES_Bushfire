
	/* Human Settlement */

	(function(){
		
		var $main = $('div[page-id="asset_vulnerability"]');
		var $div = $('ul.data', $main);

		var data = {
			01: {text: 'Are occupants likely to understand and act on bushfire messages before, during and after a bushfire event?<ul><li>Likely to be able to make decisions independently and under stress<li>Occupants are able-bodies or self-reliant<li>Children or elderly occupants are not likely to be alone</ul>', yes: 3, no: 2},
			02: {text: 'Campgrounds, caravan parks and other temporary accommodation with reduced construction standards are considered highly vulnerable', 'and': 17},
			03: {text: 'Occupants are predominantly permanent residents?<ul><li>Not holiday homes<li>Residents are not new to the area</ul>', yes: 5, no: 4},
			04: {text: 'Areas with a high number of seasonal or non-permanent populations are considered highly vulnerable', 'and': 17},
			05: {text: 'Is the asset/s categorised as Special Risk or a facility that is critical during a bushfire emergency?<ul><li>Relocation or management of occupants presents challenges or difficulties - eg: children, elderly, non-abled bodied people etc.<li>Occupants have a reduced capacity to understand risk and act on bushfire messages<li>Occupants are vulnerable to stress, anxiety or the effects of smoke<li>Significant communication barriers exist<li>Facility is critical to the community during a bushfire emergency</ul>', yes: 6, no: 8},
			06: {text: 'Appropriate systems, policies, procedures and people are in place for an emergency?', yes: 7, no: 17},
			07: {text: 'Is the asset/s of suitable condition and constructed for the bushfire hazard level?<ul><li>Structures are BAL compliant<li>Properties are well maintained and prepared</ul>', yes: 12, no: 17},
			08: {text: 'Is the asset/s of suitable condition and constructed for the bushfire hazard level?<ul><li>Structures are BAL compliant<li>Properties are well maintained and prepared</ul>', yes: 11, no: 9},
			09: {text: 'The structure is not BAL compliant but has predominantly non-combustible exterior construction materials with no gaps greater than 3mm around windows, doors and roofing', yes: 12, no: 10},
			10: {text: 'Structures that are not BAL compliant and are timber/fibre-cement construction are highly vulnerable', 'and': 17},
			11: {text: 'Is there an adequate defendable space around the asset/s?<ul><li>APZ (meeting at least BAL-29) maintained around asset<li>Adequate water supply<li>Firebreak notices are actioned and enforced or not required</ul>', yes: 13, no: 14},
			12: {text: 'Is there an adequate defendable space around the asset/s?<ul><li>APZ (meeting at least BAL-29) maintained around asset<li>Adequate water supply<li>Firebreak notices are actioned and enforced or not required</ul>', yes: 14, no: 17},
			13: {text: 'Occupants are bushfire aware?<ul><li>Active community engagement<li>Targeted community programs</ul>', yes: 15, no: 14},
			14: {text: 'Are there adequate options for access/egress of both residents and emergency services?<ul><li>Access across paddocks or parks that are not a hazard<li>Access tracks are trafficable and allow vehicles to pass or turn around<li>Slope, low trees or other barriers do not prevent access or inhibit response by emergency services</ul>', yes: 16, no: 17},
			15: {text: 'Low Vulnerability', colour: '#5cb85c'},
			16: {text: 'Moderate Vulnerability', colour: '#ec971f'},
			17: {text: 'High Vulnerability', colour: '#d9534f'},
		};

		function question(id){

			if(typeof data[id] == 'undefined') return;
			if(typeof data[id].colour !== 'undefined'){
				var text = data[id].text;
				text = text.split(' ');
				$('button.update', $main).data('asset_vulnerability', text[0]).show();
			} else {
				$('button.update', $main).hide();
			}
			
			var html = '<li class="list-group-item" style="' + (typeof data[id].colour !== 'undefined' ? ('background:' + data[id].colour + ';color:white;text-align:center;line-height:34px') : '') + '" data-id="' + id + '">';
			
			if(typeof data[id]['yes'] !== 'undefined'){
				html += '<div class="btn-group">\
					<button class="btn btn-default">Yes<input type="radio" name="question[' + id + ']" value="yes"></button>\
					<button class="btn btn-default">No<input type="radio" name="question[' + id + ']" value="no"></button>\
				</div>';
			}
			
			html += '<span>' + data[id].text + '</span></li>';
			
			if(typeof data[id]['and'] !== 'undefined'){
				html += question(data[id]['and']);
			}
			
			/*'<li class="list-group-item" style="background:#5cb85c;color:white"><b>' + data[goto].text + '</b></li>'*/
			
			return html;

		}
		
		$div.append(question(1)).on('change', 'li[data-id] input', function(){

			var $this = $(this);
			var $id = $this.closest('li[data-id]').data('id');

			$this.closest('li[data-id]').nextAll().remove();
			
			if($this.val().length == 0) return;

			var goto = data[$id][$this.val()];
			$div.append(question(goto));

		});
		
		$('button.reset', $main).on('click', function(){
			$div.html(question(1));
		});
		
	})();
